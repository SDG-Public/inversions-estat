{
	"name": "DF_HIST_LIA_FACT_ADJUDICACIONS",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "STG_LIA_FACT_ADJUDICACIONS",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "HIST_LIA_FACT_ADJUDICACIONS",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Any as string ('2021'),",
				"     Mes as string ('01')",
				"}",
				"source(output(",
				"          Identificador as string,",
				"          {Link licitación} as string,",
				"          {Fecha actualización} as string,",
				"          {Número de expediente} as string,",
				"          Lote as string,",
				"          {Objeto licitación/lote} as string,",
				"          {Presupuesto base con impuestos licitación/lote} as string,",
				"          {Presupuesto base sin impuestos licitación/lote} as string,",
				"          {CPV licitación/lote} as string,",
				"          {Lugar ejecución licitación/lote} as string,",
				"          {Resultado licitación/lote} as string,",
				"          {Fecha del acuerdo licitación/lote} as string,",
				"          {Número de ofertas recibidas por licitación/lote} as string,",
				"          {Precio de la oferta más baja por licitación/lote} as string,",
				"          {Precio de la oferta más alta por licitación/lote} as string,",
				"          {Se han excluído ofertas por ser anormalmente bajas por licitación/lote} as string,",
				"          {Número del contrato licitación/lote} as string,",
				"          {Fecha formalización del contrato licitación/lote} as string,",
				"          {Fecha entrada en vigor del contrato de licitación/lote} as string,",
				"          {Adjudicatario licitación/lote} as string,",
				"          {Tipo de identificador de adjudicatario por licitación/lote} as string,",
				"          {Identificador Adjudicatario de la licitación/lote} as string,",
				"          {El adjudicatario es o no PYME de la licitación/lote} as string,",
				"          {Importe adjudicación sin impuestos licitación/lote} as string,",
				"          {Importe adjudicación con impuestos licitación/lote} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source1",
				"source1 derive(DATA_CARREGA = currentDate(),",
				"          DATA_ANY_MES_FITXER = concat($Any,$Mes)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Identificador as string,",
				"          {Link licitación} as string,",
				"          {Fecha actualización} as string,",
				"          {Número de expediente} as string,",
				"          Lote as string,",
				"          {Objeto licitación/lote} as string,",
				"          {Presupuesto base con impuestos licitación/lote} as string,",
				"          {Presupuesto base sin impuestos licitación/lote} as string,",
				"          {CPV licitación/lote} as string,",
				"          {Lugar ejecución licitación/lote} as string,",
				"          {Resultado licitación/lote} as string,",
				"          {Fecha del acuerdo licitación/lote} as string,",
				"          {Número de ofertas recibidas por licitación/lote} as string,",
				"          {Precio de la oferta más baja por licitación/lote} as string,",
				"          {Precio de la oferta más alta por licitación/lote} as string,",
				"          {Se han excluído ofertas por ser anormalmente bajas por licitación/lote} as string,",
				"          {Número del contrato licitación/lote} as string,",
				"          {Fecha formalización del contrato licitación/lote} as string,",
				"          {Fecha entrada en vigor del contrato de licitación/lote} as string,",
				"          {Adjudicatario licitación/lote} as string,",
				"          {Tipo de identificador de adjudicatario por licitación/lote} as string,",
				"          {Identificador Adjudicatario de la licitación/lote} as string,",
				"          {El adjudicatario es o no PYME de la licitación/lote} as string,",
				"          {Importe adjudicación sin impuestos licitación/lote} as string,",
				"          {Importe adjudicación con impuestos licitación/lote} as string,",
				"          DATA_ANY_MES_FITXER as integer,",
				"          DATA_CARREGA as date",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          Identificador,",
				"          {Link licitación},",
				"          {Fecha actualización},",
				"          {Número de expediente},",
				"          Lote,",
				"          {Objeto licitación/lote},",
				"          {Presupuesto base con impuestos licitación/lote},",
				"          {Presupuesto base sin impuestos licitación/lote},",
				"          {CPV licitación/lote},",
				"          {Lugar ejecución licitación/lote},",
				"          {Resultado licitación/lote},",
				"          {Fecha del acuerdo licitación/lote},",
				"          {Número de ofertas recibidas por licitación/lote},",
				"          {Precio de la oferta más baja por licitación/lote},",
				"          {Precio de la oferta más alta por licitación/lote},",
				"          {Se han excluído ofertas por ser anormalmente bajas por licitación/lote},",
				"          {Número del contrato licitación/lote},",
				"          {Fecha formalización del contrato licitación/lote},",
				"          {Fecha entrada en vigor del contrato de licitación/lote},",
				"          {Adjudicatario licitación/lote},",
				"          {Tipo de identificador de adjudicatario por licitación/lote},",
				"          {Identificador Adjudicatario de la licitación/lote},",
				"          {El adjudicatario es o no PYME de la licitación/lote},",
				"          {Importe adjudicación sin impuestos licitación/lote},",
				"          {Importe adjudicación con impuestos licitación/lote},",
				"          DATA_ANY_MES_FITXER,",
				"          DATA_CARREGA",
				"     )) ~> sink1"
			]
		}
	}
}