{
	"name": "DF_HIST_LIA_FACT_LICITACIONS",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "STG_LIA_FACT_LICITACIONS",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "HIST_LIA_FACT_LICITACIONS",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Any as string ('2021'),",
				"     Mes as string ('01')",
				"}",
				"source(output(",
				"          Identificador as string,",
				"          {Link licitación} as string,",
				"          {Fecha actualización} as string,",
				"          {Vigente/Anulada/Archivada} as string,",
				"          {Primera publicación} as string,",
				"          Estado as string,",
				"          {Número de expediente} as string,",
				"          {Objeto del Contrato} as string,",
				"          {Valor estimado del contrato} as string,",
				"          {Presupuesto base sin impuestos} as string,",
				"          {Presupuesto base con impuestos} as string,",
				"          CPV as string,",
				"          {Tipo de contrato} as string,",
				"          {Lugar de ejecución} as string,",
				"          {Órgano de Contratación} as string,",
				"          {ID OC en PLACSP} as string,",
				"          {NIF OC} as string,",
				"          DIR3 as string,",
				"          {Enlace al Perfil de Contratante del OC} as string,",
				"          {Tipo de Administración} as string,",
				"          {Código Postal} as string,",
				"          {Tipo de procedimiento} as string,",
				"          {Sistema de contratación} as string,",
				"          {Tramitación} as string,",
				"          {Forma de presentación de la oferta} as string,",
				"          {Fecha de presentación de ofertas} as string,",
				"          {Fecha de presentación de solicitudes de participacion} as string,",
				"          {Directiva de aplicación} as string,",
				"          {Financiación Europea y fuente} as string,",
				"          {Descripción de la financiación europea} as string,",
				"          {Subcontratación permitida} as string,",
				"          {Subcontratación permitida porcentaje} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source1",
				"source1 derive(DATA_CARREGA = currentDate(),",
				"          DATA_ANY_MES_FITXER = concat($Any,$Mes)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Identificador as string,",
				"          {Link licitación} as string,",
				"          {Fecha actualización} as string,",
				"          {Vigente/Anulada/Archivada} as string,",
				"          {Primera publicación} as string,",
				"          Estado as string,",
				"          {Número de expediente} as string,",
				"          {Objeto del Contrato} as string,",
				"          {Valor estimado del contrato} as string,",
				"          {Presupuesto base sin impuestos} as string,",
				"          {Presupuesto base con impuestos} as string,",
				"          CPV as string,",
				"          {Tipo de contrato} as string,",
				"          {Lugar de ejecución} as string,",
				"          {Órgano de Contratación} as string,",
				"          {ID OC en PLACSP} as string,",
				"          {NIF OC} as string,",
				"          DIR3 as string,",
				"          {Enlace al Perfil de Contratante del OC} as string,",
				"          {Tipo de Administración} as string,",
				"          {Código Postal} as string,",
				"          {Tipo de procedimiento} as string,",
				"          {Sistema de contratación} as string,",
				"          {Tramitación} as string,",
				"          {Forma de presentación de la oferta} as string,",
				"          {Fecha de presentación de ofertas} as string,",
				"          {Fecha de presentación de solicitudes de participacion} as string,",
				"          {Directiva de aplicación} as string,",
				"          {Financiación Europea y fuente} as string,",
				"          {Descripción de la financiación europea} as string,",
				"          {Subcontratación permitida} as string,",
				"          {Subcontratación permitida porcentaje} as string,",
				"          DATA_ANY_MES_FITXER as integer,",
				"          DATA_CARREGA as date",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          Identificador,",
				"          {Link licitación},",
				"          {Fecha actualización},",
				"          {Vigente/Anulada/Archivada},",
				"          {Primera publicación},",
				"          Estado,",
				"          {Número de expediente},",
				"          {Objeto del Contrato},",
				"          {Valor estimado del contrato},",
				"          {Presupuesto base sin impuestos},",
				"          {Presupuesto base con impuestos},",
				"          CPV,",
				"          {Tipo de contrato},",
				"          {Lugar de ejecución},",
				"          {Órgano de Contratación},",
				"          {ID OC en PLACSP},",
				"          {NIF OC},",
				"          DIR3,",
				"          {Enlace al Perfil de Contratante del OC},",
				"          {Tipo de Administración},",
				"          {Código Postal},",
				"          {Tipo de procedimiento},",
				"          {Sistema de contratación},",
				"          {Tramitación},",
				"          {Forma de presentación de la oferta},",
				"          {Fecha de presentación de ofertas},",
				"          {Fecha de presentación de solicitudes de participacion},",
				"          {Directiva de aplicación},",
				"          {Financiación Europea y fuente},",
				"          {Descripción de la financiación europea},",
				"          {Subcontratación permitida},",
				"          {Subcontratación permitida porcentaje},",
				"          DATA_ANY_MES_FITXER,",
				"          DATA_CARREGA",
				"     )) ~> sink1"
			]
		}
	}
}